{"version":3,"file":"status.js","sourceRoot":"","sources":["../../../../src/components/modules/create-account/status.tsx"],"names":[],"mappings":";AAAA,OAAO,EAAE,YAAY,EAAE,MAAM,SAAS,CAAC;AACvC,OAAO,EAAE,EAAE,EAAE,MAAM,SAAS,CAAC;AAC7B,OAAO,EAAE,OAAO,EAAE,MAAM,OAAO,CAAC;AAehC,MAAM,UAAU,MAAM,CAAC,EACrB,QAAQ,EACR,UAAU,EACV,KAAK,EACL,SAAS,GACG;IACZ,MAAM,OAAO,GAAG,UAAU,CAAC,MAAM,KAAK,SAAS,IAAI,KAAK,CAAC;IACzD,MAAM,cAAc,GAAG,KAAK,EAAE,OAAO,EAAE,QAAQ,CAC7C,mDAAmD,CACpD,CAAC;IAEF,MAAM,YAAY,GAAG,OAAO,CAAC,GAAG,EAAE;QAChC,IAAI,UAAU,CAAC,KAAK,EAAE,CAAC;YACrB,OAAO,UAAU,CAAC,KAAK,CAAC,OAAO,CAAC;QAClC,CAAC;QAED,IAAI,cAAc,EAAE,CAAC;YACnB,OAAO,8DAA8D,CAAC;QACxE,CAAC;QAED,OAAO,KAAK,EAAE,OAAO,CAAC;IACxB,CAAC,EAAE,CAAC,UAAU,EAAE,KAAK,EAAE,cAAc,CAAC,CAAC,CAAC;IAExC,MAAM,OAAO,GAAG,OAAO,CAAC,GAAG,EAAE;QAC3B,OAAO,OAAO;YACZ,CAAC,CAAC,YAAY;YACd,CAAC,CAAC,CAAC,QAAQ;gBACT,CAAC,CAAC,kBAAkB;gBACpB,CAAC,CAAC,UAAU,CAAC,MAAM,KAAK,YAAY;oBAClC,CAAC,CAAC,sBAAsB;oBACxB,CAAC,CAAC,UAAU,CAAC,MAAM,KAAK,OAAO;wBAC7B,CAAC,CAAC,UAAU,CAAC,MAAM;4BACjB,CAAC,CAAC,gCAAgC;4BAClC,CAAC,CAAC,wCAAwC;wBAC5C,CAAC,CAAC,UAAU,CAAC,KAAK,EAAE,OAAO,IAAI,kBAAkB,CAAC;IAC5D,CAAC,EAAE,CAAC,UAAU,EAAE,YAAY,EAAE,QAAQ,EAAE,OAAO,CAAC,CAAC,CAAC;IAElD,OAAO,CACL,eAAK,SAAS,EAAC,gDAAgD,aAC7D,KAAC,KAAK,IAAC,SAAS,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC,CAAC,OAAO,YAC1C,OAAO,GACF,EAEP,cAAc,IAAI,KAAC,SAAS,KAAG,IAC5B,CACP,CAAC;AACJ,CAAC;AAED,SAAS,KAAK,CAAC,EACb,QAAQ,EACR,KAAK,EACL,SAAS,GAKV;IACC,OAAO,CACL,cACE,SAAS,EAAE,EAAE,CACX,+EAA+E,EAC/E,KAAK;YACH,CAAC,CAAC,gDAAgD;YAClD,CAAC,CAAC,oCAAoC,EACxC,SAAS,CACV,YAED,eAAM,SAAS,EAAC,4BAA4B,YAAE,QAAQ,GAAQ,GAC1D,CACP,CAAC;AACJ,CAAC;AAED,SAAS,SAAS;IAChB,OAAO,CACL,KAAC,KAAK,IAAC,KAAK,kBACV,eAAK,SAAS,EAAC,gDAAgD,aAC7D,eAAM,SAAS,EAAC,qBAAqB,2CAAkC,EACvE,aACE,IAAI,EAAC,sDAAsD,EAC3D,MAAM,EAAC,QAAQ,EACf,SAAS,EAAC,uDAAuD,aAEjE,6CAA4B,EAC5B,KAAC,YAAY,IAAC,IAAI,EAAC,IAAI,GAAG,IACxB,IACA,GACA,CACT,CAAC;AACJ,CAAC","sourcesContent":["import { ExternalIcon } from \"@/index\";\nimport { cn } from \"@/utils\";\nimport { useMemo } from \"react\";\n\nexport type ValidationState = {\n  status: \"idle\" | \"validating\" | \"valid\" | \"invalid\";\n  error?: Error;\n  exists?: boolean;\n};\n\ninterface StatusProps {\n  username: string;\n  validation: ValidationState;\n  error?: Error;\n  className?: string;\n}\n\nexport function Status({\n  username,\n  validation,\n  error,\n  className,\n}: StatusProps) {\n  const isError = validation.status === \"invalid\" || error;\n  const isTimeoutError = error?.message?.includes(\n    \"The operation either timed out or was not allowed\",\n  );\n\n  const errorMessage = useMemo(() => {\n    if (validation.error) {\n      return validation.error.message;\n    }\n\n    if (isTimeoutError) {\n      return \"Passkey signing timed out or was canceled. Please try again.\";\n    }\n\n    return error?.message;\n  }, [validation, error, isTimeoutError]);\n\n  const message = useMemo(() => {\n    return isError\n      ? errorMessage\n      : !username\n        ? \"Enter a Username\"\n        : validation.status === \"validating\"\n          ? \"Checking username...\"\n          : validation.status === \"valid\"\n            ? validation.exists\n              ? \"Welcome! Select Log In to play\"\n              : \"Welcome! Let's create a new Controller\"\n            : validation.error?.message || \"Enter a Username\";\n  }, [validation, errorMessage, username, isError]);\n\n  return (\n    <div className=\"flex flex-col bg-translucent-dark-100 gap-y-px\">\n      <Block className={className} error={!!isError}>\n        {message}\n      </Block>\n\n      {isTimeoutError && <HelpBlock />}\n    </div>\n  );\n}\n\nfunction Block({\n  children,\n  error,\n  className,\n}: {\n  children: React.ReactNode;\n  error?: boolean;\n  className?: string;\n}) {\n  return (\n    <div\n      className={cn(\n        \"flex justify-between items-center text-xs px-3 py-2 w-full box-border min-w-0\",\n        error\n          ? \"bg-destructive-100 text-destructive-foreground\"\n          : \"bg-background-300 text-primary-100\",\n        className,\n      )}\n    >\n      <span className=\"break-words min-w-0 flex-1\">{children}</span>\n    </div>\n  );\n}\n\nfunction HelpBlock() {\n  return (\n    <Block error>\n      <div className=\"flex items-center justify-between w-full gap-2\">\n        <span className=\"min-w-0 flex-shrink\">Having trouble signing up?</span>\n        <a\n          href=\"https://docs.cartridge.gg/controller/passkey-support\"\n          target=\"_blank\"\n          className=\"flex items-center gap-1 hover:underline flex-shrink-0\"\n        >\n          <span>Controller Docs</span>\n          <ExternalIcon size=\"xs\" />\n        </a>\n      </div>\n    </Block>\n  );\n}\n"]}